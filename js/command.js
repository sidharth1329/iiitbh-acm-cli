shell.command=function(){var c=shell.gui.inputfield.value;var b=c.split(" ");var f=new Array();for(i=0;i<b.length;i++){if(b[i]!=""){if(b[0]!="set"&&b[0]!="settings"){var g=1;while(shell.config.urls[g]){if(b[i]==g){b[i]=shell.config.urls[g];if(i==0){f.push("open")}}g++}}f.push(b[i])}}var d;for(key in shell.modules.list){if(shell.lib.in_array(shell.modules.list[key].aliases,f[0])){d=shell.modules.list[key];f[0]=d.name;break}}if(f.length==0&&shell.config.moreobj&&shell.config.moreobj.hasmore){d=shell.modules.list.more;f[0]="more"}var a=f.join(" ");if(encodeURIComponent(a)!=shell.lib.get("q")&&a!="more"&&a!="logout"){window.location.hash="#"+encodeURIComponent(a)}shell.gui.out("<div class='input'><span class='less'>"+shell.gui.prompt+"</span>"+a.replace(/</g,"&lt;")+"</div>");if(a!=""){shell.keyboard.hist[shell.keyboard.hist.length]=a;shell.keyboard.histpos=shell.keyboard.hist.length}var e="";if(!d){d=shell.modules.list[shell.config.mode]}else{for(i=0;i<f.length-1;i++){f[i]=f[i+1]}f.pop()}if(d.more&&f.length>0){this.config.moreobj=d}if(f.length==0&&d.mode){shell.config.mode=d.name;shell.gui.updateprompt()}else{d.call(f)}shell.gui.scroll();shell.gui.inputfield.value="";shell.gui.focusinput();return false};shell.onload=function(c,d){var a=false;try{if(parent.shell!=shell){var f=document.getElementById("body");f.innerHTML="";shell=parent.shell;a=true}}catch(c){}shell.gui.init();if(!d&&(a||document.cookie.indexOf("loggedin")!=-1)){shell.ajax.query("http://goosh.appspot.com/status?callback=shell.onload");return}else{if(shell.ajax.iscontext(c)){shell.config.user=d;var b=shell.gui.el("shelllogin");var e=shell.gui.el("shellloginparent");if(b&&e){shell.gui.outputel.removeChild(shell.gui.outputel.lastChild)}}}if(d&&d!="guest"){shell.lib.cookie.set("loggedin","1",365)}shell.set.init()};shell.getquery=function(){var a="";if(shell.lib.get("q")){a=shell.lib.get("q")}if(window.location.hash){a=decodeURIComponent(window.location.hash.substr(1))}a+=" ";if(a!=" "&&a.substr(0,6)!="login "&&a.substr(0,4)!="set "&&a.substr(0,9)!="settings "){shell.gui.inputfield.value=a.substr(0,a.length)}else{shell.gui.inputfield.value=""}shell.gui.updateprompt();shell.gui.showinput();shell.gui.focusinput();if(shell.gui.inputfield.value!=""){shell.command()}};if(typeof window.addEventListener!=="undefined"){window.addEventListener("load",shell.onload,false)}else{if(typeof window.attachEvent!=="undefined"){window.attachEvent("onload",shell.onload)}};
